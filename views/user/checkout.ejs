<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Coza store</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/images/Chrome-Incognito-Mode-Icon-256.png" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Other CSS -->
    <link rel="stylesheet" type="text/css" href="userAssets/fonts/font-awesome-4.7.0/css/font-awesome.css">
    <link rel="stylesheet" type="text/css" href="userAssets/fonts/iconic/css/material-design-iconic-font.min.css">
    <link rel="stylesheet" type="text/css" href="userAssets/fonts/linearicons-v1.0.0/icon-font.min.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/animsition/css/animsition.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/css-hamburgers/hamburgers.min.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/animsition/css/animsition.min.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/select2/select2.min.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/daterangepicker/daterangepicker.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/slick/slick.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/MagnificPopup/magnific-popup.css">
    <link rel="stylesheet" type="text/css" href="userAssets/vendor/perfect-scrollbar/perfect-scrollbar.css">
    <!--  custom CSS -->
    <link rel="stylesheet" type="text/css" href="userAssets/css/util.css">
    <link rel="stylesheet" href="userAssets/css/style.css">
    <link rel="stylesheet" href="userAssets/css/myStyle.css">
    <link rel="stylesheet" href="userAssets/css/main.css">
    <link rel="stylesheet" href="userAssets/css/stylesheet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap-grid.min.css"
        integrity="sha512-ZuRTqfQ3jNAKvJskDAU/hxbX1w25g41bANOVd1Co6GahIe2XjM6uVZ9dh0Nt3KFCOA061amfF2VeL60aJXdwwQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="animsition" id="reloadDiv">
    <!-- Header -->
    <header class="header-v3">
        <div class="container-menu-desktop trans-03">
            <!-- Topbar -->
            <div class="top-bar">
                <div class="content-topbar flex-sb-m h-full container">
                    <div class="left-top-bar">
                        Free shipping for standard orders over $100
                    </div>

                    <div class="right-top-bar flex-w h-full">
                        <a href="/contactUS" class="flex-c-m trans-04 p-lr-25">
                            Help & FAQs
                        </a>
                        <span class="icon-heart1"></span>
                        <%if(userName){%>
                            <a href="/profile" class="flex-c-m trans-04 p-lr-25">
                                <%=userName%>
                            </a>
                            <%}else{%>
                                <a href="/login" class="flex-c-m trans-04 p-lr-25">Account</a>
                                <%}%>
                                    <a href="#" class="flex-c-m trans-04 p-lr-25">
                                        EN
                                    </a>

                                    <a href="#" class="flex-c-m trans-04 p-lr-25">
                                        INR
                                    </a>
                    </div>
                </div>
            </div>

            <div class="wrap-menu-desktop">
                <nav class="limiter-menu-desktop container">
                    <!-- Logo desktop -->
                    <a href="#" class="logo">
                        <img src="images/icons/logo-01.png" alt="IMG-LOGO">
                    </a>

                    <!-- Menu desktop -->
                    <div class="menu-desktop">
                        <ul class="main-menu">
                            <li>
                                <a href="/home">Home</a>
                            </li>

                            <li>
                                <a href="/shop">Shop</a>
                            </li>

                            <li>
                                <a href="/aboutUs">About</a>
                            </li>

                            <li>
                                <a href="/contactUS">Contact</a>
                            </li>
                        </ul>
                    </div>

                    <!-- Icon header -->
                    <div class="wrap-icon-header flex-w flex-r-m">
                        <div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-modal-search">
                            <i class="zmdi zmdi-search"></i>
                        </div>

                        <a href="/cart">
                            <div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-cart">
                                <i class="zmdi zmdi-shopping-cart"></i>
                            </div>
                        </a>

                        <a href="/wishlist" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
                            <i class="zmdi zmdi-favorite-outline"></i>
                        </a>

                        <a href="/profile">
                            <div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-user">
                                <i class="zmdi zmdi-account-circle"></i>
                            </div>
                        </a>
                    </div>
                </nav>
            </div>
        </div>

        <!-- Header Mobile -->
        <div class="wrap-header-mobile">
            <!-- Logo mobile -->
            <div class="logo-mobile">
                <a href="/"><img src="" alt="IMG-LOGO"></a>
            </div>

            <!-- Icon header -->
            <div class="wrap-icon-header flex-w flex-r-m m-r-15">
                <a href="/cart">
                    <div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10  js-show-cart">
                        <i class="zmdi zmdi-shopping-cart"></i>
                    </div>
                </a>

                <a href="/wishlist" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 ">
                    <i class="zmdi zmdi-favorite-outline"></i>
                </a>
                <a href="/profile">
                    <div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-user">
                        <i class="zmdi zmdi-account-circle"></i>
                    </div>
                </a>
            </div>

            <!-- Button to show menu on mobile -->
            <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div class="menu-mobile">
            <ul class="main-menu-m">
                <li>
                    <a href="/home">Home</a>
                </li>

                <li>
                    <a href="/shop">Shop</a>
                </li>


                <li>
                    <a href="/aboutUs">About</a>
                </li>

                <li>
                    <a href="/contactUs">Contact</a>
                </li>
            </ul>
        </div>

        <!-- Modal Search -->
        <div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
            <div class="container-search-header">
                <button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
                    <img src="images/icons/icon-close2.png" alt="CLOSE">
                </button>

                <form class="wrap-search-header flex-w p-l-15" action="/filter" method="get">
                    <button class="flex-c-m trans-04">
                        <i class="zmdi zmdi-search"></i>
                    </button>
                    <input class="plh3" type="text" name="search" placeholder="Search...">
                    <input type="radio" name="sort" value="0" checked hidden>
                    <input type="radio" name="price" value="0-10000000000" checked hidden>
                    <input type="radio" name="category" value="all" checked hidden>
                </form>
            </div>
        </div>
    </header>
    <div class="page-content" style="padding-top: 80px">
        <nav aria-label="breadcrumb" class="breadcrumb-nav mb-3">
            <div class="container">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item"><a href="/cart">Cart</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Checkout</li>
                </ol>
            </div><!-- End .container -->
        </nav><!-- End .breadcrumb-nav -->
        <div class="checkout">
            <form id="form">
                <div class="container">
                    <% if (couponData.length>0){%>
                        <div id="reloadArea2">
                            <div class="flex-w flex-m m-r-20 m-tb-5">
                                <div class="btn btn-outline-primary-2 btn-order" id="btn-coupon" data-toggle="collapse"
                                    data-target="#couponCollapse">
                                    <a href=""></a> Apply coupon
                                </div>
                            </div>
                        </div>
                        <div id="couponCollapse" class="collapse" style="justify-content: flex-start;">
                            <div class="row" id="couponField">
                                <% couponData.forEach(function(coupons, index) { %>
                                    <div class="col-lg-2" style="width: 100%;">
                                        <div class="card card-dashboard" style="width: 60%;">
                                            <div class="card-body">
                                                <input type="text" hidden name="" id="coupon"
                                                    value="<%= coupons.maximumDiscountAmount %>">
                                                <input type="radio" id="couponId" name="couponId"
                                                    data-val="<%= coupons.maximumDiscountAmount %>"
                                                    value="<%= coupons.couponCode%>">
                                                <h3 class="card-title">
                                                    <%= coupons.description %>
                                                </h3>
                                                <p>Coupon code: <%= coupons.couponCode %><br>
                                            </div>
                                        </div>
                                    </div>
                                    <% }); %>
                            </div>
                        </div>
                        <%}else{%>
                            <div id="reloadArea2">
                                <div class="flex-w flex-m m-r-20 m-tb-5">
                                    <div class="btn btn-outline-primary-2 btn-order" id="btn-coupon"
                                        data-toggle="collapse" data-target="#couponCollapse">
                                        <a href=""></a> Apply coupon
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex;">
                                <p id="couponCollapse" class="collapse" style="left: 0px;">no coupons</p>
                            </div>

                            <%}%>
                                <div class="row">
                                    <div class="col-lg-9">
                                        <div class="row" id="address-select">
                                            <% if(userData.address.length==0){%>
                                                <center>you doesn't have any address , you have to create new address
                                                </center>
                                                <%}else{%>
                                                    <% userData.address.forEach(function(address, index) { %>
                                                        <div class="col-lg-6">
                                                            <div class="card card-dashboard">
                                                                <div class="card-body">
                                                                    <input type="radio" name="address"
                                                                        value="<%= index %>" <%=index===0 ? 'checked'
                                                                        : '' %> >
                                                                    <h3 class="card-title">Address <%= index + 1 %>
                                                                    </h3>
                                                                    <p>Name: <%= address.name %><br>
                                                                            colony: <%= address.colony %><br>
                                                                                Mobile: <%= address.mobile %><br>
                                                                                    State: <%= address.state %><br>
                                                                                        City: <%= address.city %><br>
                                                                                            House Name: <%=
                                                                                                address.house %>
                                                                                                <br>
                                                                                                Pincode: <%=
                                                                                                    address.pincode %>
                                                                                                    <br>
                                                                                                    <a
                                                                                                        href="/editAddress?id=<%=address._id%>">Edit
                                                                                                        <i
                                                                                                            class="icon-edit"></i></a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <% }); %>
                                                            <%}%>
                                        </div>
                                        <div class="btn btn-outline-primary-2 btn-order" data-toggle="collapse"
                                            data-target="#tab-addAddress" id="addAddressButton">
                                            Add Adresses
                                        </div>
                                        <div class="tab-pane fade" id="tab-addAddress" role="tabpanel"
                                            aria-labelledby="tab-addAddress-link">
                                            <h3>Add Address</h3>
                                            <form id="addAddressForm">
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <label>Full name *</label>
                                                        <input type="text" class="form-control" name="name" id="name">
                                                        <p style="color: red; display: none; top: 10px; font-size:  1.3rem;"
                                                            id="nameError">
                                                            name is required*</p>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <label>Mobile *</label>
                                                        <input type="number" class="form-control" name="mobile"
                                                            id="mobile">
                                                        <p style="color: red; display: none; font-size:  1.3rem;"
                                                            id="mobileError">mobile is
                                                            must be 10 number*</p>
                                                    </div><!-- End .col-sm-6 -->

                                                    <div class="col-sm-12">
                                                        <label>House name *</label>
                                                        <input type="text" class="form-control" id="house" name="house">
                                                        <p style="color: red; display: none;font-size:  1.3rem;"
                                                            id="houseError">house name
                                                            is required*</p>
                                                    </div><!-- End .col-sm-6 -->
                                                    <div class="col-sm-6">
                                                        <label>Colony *</label>
                                                        <input type="text" class="form-control" name="colony"
                                                            id="colony">
                                                        <p style="color: red; display: none;font-size:  1.3rem;"
                                                            id="colonyError">colony is
                                                            required*</p>
                                                    </div><!-- End .col-sm-6 -->

                                                    <div class="col-sm-6">
                                                        <label>State *</label>
                                                        <input type="text" class="form-control" id="state" name="state">
                                                        <p style="color: red; display: none;font-size:  1.3rem;"
                                                            id="stateError"> state is
                                                            required*</p>
                                                    </div><!-- End .col-sm-6 -->

                                                    <div class="col-sm-6">
                                                        <label>City *</label>
                                                        <input type="text" class="form-control" id="city" name="city">
                                                        <p style="color:red; display: none;font-size:  1.3rem;"
                                                            id="cityError">city is
                                                            required*</p>
                                                    </div><!-- End .col-sm-6 -->

                                                    <div class="col-sm-6">
                                                        <label>Pincode *</label>
                                                        <input type="number" class="form-control" name="pincode"
                                                            id="pincode">
                                                        <p style="color: red; display: none;font-size:  1.3rem;"
                                                            id="pincodeError">pincode
                                                            is required*</p>
                                                    </div><!-- End .col-sm-6 -->
                                                </div><!-- End .row -->
                                                <button type="submit" onclick="addAddress(event)"
                                                    class="btn btn-outline-primary-2">
                                                    <span>Add Address</span>
                                                    <i class="icon-long-arrow-right"></i>
                                                </button>
                                            </form>

                                        </div><!-- Add address form end -->

                                    </div>
                                    <aside class="col-lg-3">
                                        <div class="summary" id="reloadArea">
                                            <h3 class="summary-title">Your Order</h3><!-- End .summary-title -->

                                            <table class="table table-summary">
                                                <thead>
                                                    <tr>
                                                        <th>Product</th>
                                                        <th>Total</th>
                                                    </tr>
                                                </thead>

                                                <tbody>
                                                    <% userData.cart.forEach(function(item, index) { %>
                                                        <tr>
                                                            <td><a href="/product?_id=<%= item.product._id %>">
                                                                    <%= item.product.productName %>
                                                                </a></td>
                                                            <td><span>
                                                                    <%= item.quantity %>x
                                                                </span>
                                                                <i class="fa-solid fa-indian-rupee-sign"></i>
                                                                <%= item.product.price %>
                                                            </td>
                                                        </tr>
                                                        <% }); %>
                                                            <tr class="summary-subtotal">
                                                                <td>Subtotal:</td>
                                                                <%let subTotal=0%>
                                                                    <%for(let i=0 ; i < userData.cart.length ; i++){%>
                                                                        <% subTotal=subTotal +
                                                                            userData.cart[i].product.price *
                                                                            userData.cart[i].quantity %>
                                                                            <%}%>
                                                                                <td id="subtotal"
                                                                                    data-val="<%= subTotal %>"><i
                                                                                        class="fa-solid fa-indian-rupee-sign"></i>
                                                                                    <%= subTotal %>
                                                                                </td>
                                                            </tr><!-- End .summary-subtotal -->
                                                            <tr>
                                                                <td>Coupon Amount:</td>
                                                                <td><i class="fa-solid fa-indian-rupee-sign">
                                                                        <p id="couponAmount"></p>
                                                                    </i>
                                                                </td>
                                                            </tr>

                                                            <tr class="summary-total">
                                                                <td>Total:</td>
                                                                <td id="total1" data-total="<%= subTotal %>"><i
                                                                        class="fa-solid fa-indian-rupee-sign"></i>
                                                                    <% let total=subTotal %>
                                                                        <%= total %>
                                                                </td>
                                                            </tr><!-- End .summary-total -->

                                                </tbody>

                                            </table><!-- End .table table-summary -->
                                            <!------------------------------------ Delivery Methods Section ------------------------------>
                                            <div class="row" style="display: flex; justify-content: space-between;">
                                                <div class="col-lg-6" style="padding-right: 10%;" id="deliveryField">
                                                    <div style="padding-top: 5%; white-space: nowrap;">
                                                        <p style="color: black; font-weight: 500; left: 0px;">Shipping
                                                            Methods:</p>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <div class="mr-2">
                                                            <input required type="radio" id="expressDelivery"
                                                                name="shippingMethods" value="express" data-charge="300"
                                                                checked />
                                                        </div>
                                                        <label for="expressDelivery" class="d-block text-dark"
                                                            style="white-space: nowrap;">Express Delivery</label>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <div class="mr-2">
                                                            <input required type="radio" id="normalDelivery"
                                                                name="shippingMethods" value="normal" data-charge="100"
                                                                checked />
                                                        </div>
                                                        <label for="normalDelivery" class="d-block text-dark"
                                                            style="white-space: nowrap;">Normal Delivery</label>
                                                    </div>
                                                </div>

                                                <div class="col-lg-6">
                                                    <div style="padding-top: 5%;">
                                                        <p style="color: black; font-weight:500;">Payment Method:</p>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <div class="mr-2">
                                                            <input required type="radio" id="cashOnDelivery"
                                                                name="payment" value="COD" checked />
                                                        </div>
                                                        <label for="cashOnDelivery" class="d-block text-dark"
                                                            style="white-space: nowrap;">Cash On Delivery</label>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <div class="mr-2">
                                                            <input required type="radio" id="onlinePayment"
                                                                name="payment" value="onlinePay" />
                                                        </div>
                                                        <label for="onlinePayment" class="d-block text-dark"
                                                            style="white-space: nowrap;">Online payment</label>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <div class="mr-2">
                                                            <input required type="radio" id="walletPayment"
                                                                name="payment" value="WALLET" />
                                                        </div>
                                                        <label for="walletPayment" class="d-block text-dark"
                                                            style="white-space: nowrap;">Wallet</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <button type="submit" id="checkOutBttn"
                                                class="btn btn-outline-primary-2 btn-order btn-block">
                                                <span class="btn-text">Place Order</span>
                                                <span class="btn-hover-text">Proceed to Checkout</span>
                                            </button>
                                        </div><!-- End .summary -->
                                    </aside><!-- End .col-lg-3 -->
                                </div><!-- End .row -->
            </form>
        </div><!-- End .container -->
    </div><!-- End .checkout -->
    </div><!-- End .page-content -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="userAssets/js/checkout.js"></script>
    <%- include('../layouts/footer.ejs') -%>